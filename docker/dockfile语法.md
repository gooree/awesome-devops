# Dockfile指令详解

## 注释
注释行以#开头，不支持跨行注释

## FROM - 指定基础镜像
```
格式: FROM <image> 或 FROM <image>[:<tag>]
```
每个Dockerfile必须以FROM指令开头，FROM指明了当前镜像创建的基镜像，也就是说每个镜像必须基于一个已存在的镜像进行创建。

## ARG - 构建参数
```
格式: ARG <参数名>[=<默认值>]
```
ARG指令定义了用户可以在创建镜像时或者运行时传递的变量，申明于调用类似于shell中的变量申明与定义。

## ENV - 环境变量
```
格式: ENV <key1>=<value1> <key2>=<value2> ...
```
ENV指令用来定义镜像的环境变量，并且可以引用已经存在的环境变量，例如：HOME、HOSTNAME、PATH。ENV的值跟ARG指令申明的变量一样可以传递、被引用，定义方法也基本一致。

## EXPOSE - 声明端口
EXPOSE指定容器在运行中监听的端口。

## COPY - 复制文件
```
shell格式: COPY <源路径>... <目标路径>
exec格式(推荐): COPY ["<源路径1>",.."<目标路径>"]
```
复制文件到容器

## ADD
同上，推荐使用COPY。ADD会自动解压压缩文件。

## VOLUME - 定义匿名卷
```
格式: VOLUME ["<路径1>", "<路径2>"...]
```
将本地文件夹挂载到当前容器，防止向容器存储层写入大量数据。

## CMD
```
shell格式: CMD <命令>
exec格式(推荐): CMD ["可执行文件", "参数1", "参数2“...]
```
容器启动命令，指定默认的容器主进程的启动命令。

注意：在运行时可以指定新的命令来替代镜像设置中的这个默认命令，具体参见docker run指令。
重点：Docker不是虚拟机，容器中的应用都应该以前台执行，容器内没有后台服务的概念。因此不支持service或systemctl命令启动后台服务。

## ENTRYPOINT 
同上，在指定容器启动时执行的程序及参数。区别是容器运行时指定的命令会被指定为入口命令的参数，而不是被替代。

# Dockfile实例
``` dockfile
# 基于哪个镜像
From java:latest
# 将本地文件夹挂载到当前容器
VOLUME /tmp
# 复制文件到容器
ADD eureka-server-1.0.0.jar /app.jar
# 声明需要暴露的端口
EXPOSE 8001
# 配置容器启动后执行的命令
ENTRYPOINT ["java","-jar","/app.jar"]
```
